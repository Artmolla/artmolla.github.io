{"version":3,"sources":["webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/disable.js","webpack://keksobooking/./source/js/popup-message.js","webpack://keksobooking/./source/js/avatar.js","webpack://keksobooking/./source/js/reset.js","webpack://keksobooking/./source/js/data.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/ad-list.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/debounce.js"],"names":["LISTING_TYPES","flat","bungalow","house","palace","cardTemplate","document","querySelector","content","getWordInRightCase","integer","wordList","integer1","Math","abs","mapFilters","typeSelect","priceSelect","roomSelect","guestSelect","featuresField","adForm","setElementsAvailability","parent","selector","available","querySelectorAll","forEach","element","disabled","classList","add","successMessageTemplate","errorMessageTemplate","fetchErrorMessageTemplate","showMessagePopup","message","appendChild","removeMessagePopupClickHandler","remove","removeEventListener","removeMessagePopupKeyHandler","evt","key","window","addEventListener","FILE_TYPES","avatarUploadButton","avatarPreviewContainer","listingPhotoUploadButton","listingPhotoPreviewContainer","uploadImage","uploadEntry","previewContainer","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","tagName","src","result","image","createElement","width","height","append","readAsDataURL","resetForm","addressField","value","MAIN_PIN_COORDINATES","lat","lng","pricePerNightInput","min","placeholder","innerHTML","reset","mainContent","MIN_PRICES","GUESTS_BY_ROOM","1","2","3","100","INVALID","listingTitle","listingTypeSelect","checkinTimeSelect","checkoutTimeSelect","roomQuantityField","guestQuantityField","submitButton","resetButton","setRoomGuestsDependence","room","guestsList","guest","children","includes","selected","setTimeDependence","checkIn","checkOut","option","listingTitleLength","length","setCustomValidity","reportValidity","input","validity","valid","valueMissing","tooShort","tooLong","validateTitleInput","preventDefault","formData","fetch","method","body","then","response","ok","cloneNode","sendData","FormData","target","mainMarker","setLatLng","setTimeout","mapContainer","map","L","on","onSuccess","errorDestination","data","renderSimilarAds","func","delay","timerId","args","boundFunc","bind","clearTimeout","removeUnmatchedAds","filter","listing","offer","type","rooms","guests","price","filterByPrice","call","every","feature","features","filterByFeatures","filterAll","json","catch","err","clonedFetchErrorMessage","textContent","createFetchErrorPopup","setView","tileLayer","attribution","addTo","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","pinIcon","marker","draggable","setAttribute","getLatLng","toFixed","similarAdsList","slice","author","location","keepInView","bindPopup","clonedCard","featureList","destination","title","address","checkin","checkout","li","description","imagesList","imagesFragment","createDocumentFragment","clonedImage","populateListingImages","photos","avatar","createCustomPopup","eachLayer","Marker"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const LISTING_TYPES = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n}\n\nexport const cardTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst getWordInRightCase = (integer, wordList) => {\n  integer = Math.abs(integer) % 100;\n  const integer1 = integer % 10;\n  if (integer > 10 && integer < 20) {\n    return wordList[2];\n  } else if (integer1 > 1 && integer1 < 5) {\n    return wordList[1];\n  } else if (integer1 === 1) {\n    return wordList[0];\n  } else {\n    return wordList[2];\n  }\n}\n\nconst populateListingFeatures = (featureList, destination) => {\n  if (featureList.length === 0) {\n    destination.remove();\n  } else {\n    destination.innerHTML = '';\n    featureList.forEach((feature => {\n      const li = document.createElement('li');\n      li.classList.add('popup__feature', `popup__feature--${feature}`);\n      destination.appendChild(li);\n    }));\n  }\n}\n\nconst populateListingImages = (imagesList, destination) => {\n  if (imagesList.length === 0) {\n    destination.remove();\n  } else {\n    const imagesFragment = document.createDocumentFragment();\n\n    imagesList.forEach((image) => {\n      const clonedImage = destination.querySelector('img').cloneNode();\n      clonedImage.src = image;\n      imagesFragment.appendChild(clonedImage);\n    });\n\n    destination.innerHTML = '';\n    destination.appendChild(imagesFragment);\n  }\n}\n\nexport const createCustomPopup = ({ author, offer }) => {\n  const clonedCard = cardTemplate.cloneNode(true);\n  clonedCard.querySelector('.popup__title').textContent = offer.title;\n  clonedCard.querySelector('.popup__text--address').textContent = offer.address;\n  clonedCard.querySelector('.popup__text--price').textContent = `${offer.price} ₽/ночь`;\n  clonedCard.querySelector('.popup__type').textContent = LISTING_TYPES[offer.type];\n  clonedCard.querySelector('.popup__text--capacity').textContent = `${offer.rooms} ${getWordInRightCase(offer.rooms, ['комната', 'комнаты', 'комнат'])} для ${offer.guests} ${getWordInRightCase(offer.guests, ['гостя', 'гостей', 'гостей'])}`;\n  clonedCard.querySelector('.popup__text--time').textContent = `Заезд после ${offer.checkin} выезд до ${offer.checkout}`;\n  populateListingFeatures(offer.features, clonedCard.querySelector('.popup__features'));\n  clonedCard.querySelector('.popup__description').textContent = offer.description;\n  populateListingImages(offer.photos, clonedCard.querySelector('.popup__photos'));\n  clonedCard.querySelector('.popup__avatar').src = author.avatar;\n  return clonedCard;\n}\n","const PRICE_CONFIGURATION = {\n  low: 1000,\n  middle: 50000,\n}\nexport const mapFilters = document.querySelector('.map__filters');\nconst typeSelect = mapFilters.querySelector('#housing-type');\nconst priceSelect = mapFilters.querySelector('#housing-price');\nconst roomSelect = mapFilters.querySelector('#housing-rooms');\nconst guestSelect = mapFilters.querySelector('#housing-guests');\nconst featuresField = mapFilters.querySelector('#housing-features');\n\nexport const filterByPrice = (listing) => {\n  switch (priceSelect.value) {\n    case 'low':\n      return listing.offer.price <= PRICE_CONFIGURATION.low;\n    case 'middle':\n      return listing.offer.price >= PRICE_CONFIGURATION.low && listing.offer.price <= PRICE_CONFIGURATION.middle;\n    case 'high':\n      return listing.offer.price >= PRICE_CONFIGURATION.middle;\n    case 'any':\n      return listing;\n  }\n};\n\nexport const filterByFeatures = (listing) => {\n  const selectedFeatures = [].map.call(featuresField.querySelectorAll('input:checked'), (input) => input.value);\n  return selectedFeatures.every((feature) => listing.offer.features.includes(feature));\n};\n\nexport const filterAll = (data) => {\n  return data.filter((listing) => {\n    return (listing.offer.type === typeSelect.value || typeSelect.value === 'any')\n      && (listing.offer.rooms === +roomSelect.value || roomSelect.value === 'any')\n      && (listing.offer.guests === +guestSelect.value || guestSelect.value === 'any')\n      && filterByPrice(listing)\n      && filterByFeatures(listing);\n  })\n}\n","import { mapFilters } from './filter.js';\n\nexport const adForm = document.querySelector('.ad-form');\n\nexport const setElementsAvailability = (parent, selector, available) => {\n  if (available === 'false') {\n    parent.querySelectorAll(selector)\n      .forEach((element) => element.disabled = true);\n  } else if (available === 'true') {\n    parent.querySelectorAll(selector)\n      .forEach((element) => element.disabled = false);\n  }\n};\n\nadForm.classList.add('ad-form--disabled');\nmapFilters.classList.add('map__filters--disabled');\nsetElementsAvailability(adForm, 'input', 'false');\nsetElementsAvailability(adForm, 'select', 'false');\nsetElementsAvailability(adForm, 'button', 'false');\nsetElementsAvailability(adForm, 'textarea', 'false');\nsetElementsAvailability(mapFilters, 'input', 'false');\nsetElementsAvailability(mapFilters, 'select', 'false');\n","export const successMessageTemplate = document.querySelector('#success').content.querySelector('.success');\nexport const errorMessageTemplate = document.querySelector('#error').content.querySelector('.error');\nexport const fetchErrorMessageTemplate = document.querySelector('#fetch-error').content.querySelector('.fetch-error');\n\nexport const createFetchErrorPopup = (err) => {\n  const clonedFetchErrorMessage = fetchErrorMessageTemplate.cloneNode(true);\n  clonedFetchErrorMessage.querySelector('.fetch-error__message').textContent = err;\n  return clonedFetchErrorMessage;\n}\n\nexport const createSuccessPopup = () => successMessageTemplate.cloneNode(true);\n\nexport const createErrorMessagePopup = () => errorMessageTemplate.cloneNode(true);\n\nexport const showMessagePopup = (parent, message) => {\n  parent.appendChild(message);\n\n  const removeMessagePopupClickHandler = () => {\n    message.remove();\n    message.removeEventListener('click', removeMessagePopupClickHandler);\n  }\n\n  const removeMessagePopupKeyHandler = (evt) => {\n    if (evt.key === 'Escape') {\n      message.remove();\n      window.removeEventListener('keydown', removeMessagePopupKeyHandler);\n    }\n  }\n\n  message.addEventListener('click', removeMessagePopupClickHandler);\n  window.addEventListener('keydown', removeMessagePopupKeyHandler);\n};\n","const FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\nconst IMAGE_DIMENTION = {\n  width: '40',\n  height: '44',\n}\n\nconst avatarUploadButton = document.querySelector('.ad-form__field input[type=file]');\nexport const avatarPreviewContainer = document.querySelector('.ad-form-header__preview img');\nconst listingPhotoUploadButton = document.querySelector('.ad-form__upload input[type=file]');\nexport const listingPhotoPreviewContainer = document.querySelector('.ad-form__photo');\n\nconst uploadImage = (uploadEntry, previewContainer) => {\n  const file = uploadEntry.files[0];\n  const fileName = file.name.toLowerCase();\n\n  const matches = FILE_TYPES.some((it) => fileName.endsWith(it));\n\n  if (matches) {\n    const reader = new FileReader();\n\n    reader.addEventListener('load', () => {\n      if (previewContainer.tagName === 'IMG') {\n        previewContainer.src = reader.result;\n      } else {\n        const image = document.createElement('IMG');\n        image.src = reader.result;\n        image.width = IMAGE_DIMENTION.width;\n        image.height = IMAGE_DIMENTION.height;\n        previewContainer.append(image);\n      }\n    });\n\n    reader.readAsDataURL(file);\n  }\n}\n\navatarUploadButton.addEventListener('change', () => uploadImage(avatarUploadButton, avatarPreviewContainer));\n\nlistingPhotoUploadButton.addEventListener('change', () => uploadImage(listingPhotoUploadButton, listingPhotoPreviewContainer));\n","import {\n  MAIN_PIN_COORDINATES\n} from './map.js';\n\nimport {\n  adForm,\n  addressField,\n  pricePerNightInput\n} from './form.js';\n\nimport {\n  avatarPreviewContainer,\n  listingPhotoPreviewContainer\n} from './avatar.js';\n\nimport { mapFilters } from './filter.js';\n\nexport const resetForm = () => {\n  adForm.reset();\n  avatarPreviewContainer.src = 'img/muffin-grey.svg';\n  addressField.value = `${MAIN_PIN_COORDINATES.lat}, ${MAIN_PIN_COORDINATES.lng}`;\n  pricePerNightInput.min = 0;\n  pricePerNightInput.placeholder = 0;\n  listingPhotoPreviewContainer.innerHTML = '';\n  mapFilters.reset();\n}\n","import {\n  createSuccessPopup,\n  createErrorMessagePopup,\n  createFetchErrorPopup,\n  showMessagePopup\n} from './popup-message.js';\n\nimport { resetForm } from './reset.js';\n\nconst mainContent = document.querySelector('main');\n\nexport const getData = (onSuccess, errorDestination) => {\n  return fetch('https://23.javascript.pages.academy/keksobooking/data')\n    .then((response) => response.json())\n    .then((data) => {\n      onSuccess(data);\n    })\n    .catch((err) => {\n      errorDestination.appendChild(createFetchErrorPopup(err));\n    });\n};\n\nexport const sendData = (formData) => {\n  fetch('https://22.javascript.pages.academy/keksobooking',\n    {\n      method: 'POST',\n      body: formData,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        showMessagePopup(mainContent, createSuccessPopup());\n        resetForm();\n      } else {\n        showMessagePopup(mainContent, createErrorMessagePopup());\n      }\n    });\n};\n","import {\n  MAIN_PIN_COORDINATES,\n  mainMarker\n} from './map.js';\n\nimport { sendData } from './data.js';\n\nconst MIN_PRICES = {\n  bungalow: '0',\n  flat: '1000',\n  house: '5000',\n  palace: '10000',\n}\nconst GUESTS_BY_ROOM = {\n  1: ['1'],\n  2: ['1', '2'],\n  3: ['1', '2', '3'],\n  100: ['0'],\n}\n\nconst INVALID = 'invalid';\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\n\nexport const adForm = document.querySelector('.ad-form');\nconst listingTitle = document.querySelector('#title');\nconst listingTypeSelect = document.querySelector('#type');\nexport const pricePerNightInput = document.querySelector('#price');\nconst checkinTimeSelect = document.querySelector('#timein');\nconst checkoutTimeSelect = document.querySelector('#timeout');\nconst roomQuantityField = document.querySelector('#room_number');\nconst guestQuantityField = document.querySelector('#capacity');\nexport const submitButton = document.querySelector('.ad-form__submit');\nexport const addressField = document.querySelector('#address');\nexport const resetButton = document.querySelector('.ad-form__reset');\n\nconst validateTitleInput = (input) => {\n  if (!input.validity.valid) {\n    input.classList.add(INVALID);\n  } else if (input.validity.valueMissing) {\n    input.setCustomValidity('Пожалуйста, заполните это поле');\n  } else if (input.value.tooShort) {\n    input.setCustomValidity(`Описание слишком короткое минимальная длинна ${MIN_TITLE_LENGTH}`);\n  } else if (input.value.tooLong) {\n    input.setCustomValidity(`Описание слишком длинное максимальная длинна ${MAX_TITLE_LENGTH}`);\n  } else {\n    input.setCustomValidity('');\n    input.classList.remove(INVALID);\n  }\n\n  input.reportValidity();\n}\n\nconst validatePrice = (input) => {\n  if (input.value >= MIN_PRICES[listingTypeSelect.value]) {\n    input.setCustomValidity('');\n    input.classList.remove(INVALID);\n  } else {\n    input.classList.add(INVALID);\n    input.setCustomValidity(`Минимальная цена для этого типа сoставляет ${MIN_PRICES[listingTypeSelect.value]}`);\n  }\n}\n\nconst setRoomGuestsDependence = (room, guestsList) => {\n  for (let guest of guestsList.children) {\n    if (GUESTS_BY_ROOM[room.value].includes(guest.value)) {\n      guest.disabled = false;\n      guest.selected = true;\n    } else {\n      guest.disabled = true;\n    }\n  }\n}\n\nconst setTimeDependence = (checkIn, checkOut) => {\n  for (let option of checkOut.children) {\n    option.value === checkIn.value\n      ? option.selected = true\n      : option.selected = false;\n  }\n}\n\nsetRoomGuestsDependence(roomQuantityField, guestQuantityField);\n\nlistingTitle.addEventListener('input', () => {\n  const listingTitleLength = listingTitle.value.length;\n  if (listingTitleLength < MIN_TITLE_LENGTH) {\n    listingTitle.setCustomValidity(`Добавьте еще ${MIN_TITLE_LENGTH - listingTitleLength} символов`);\n  } else if (listingTitleLength > MAX_TITLE_LENGTH) {\n    listingTitle.setCustomValidity(`Слишком длинное описание, удалите ${listingTitleLength - MAX_TITLE_LENGTH} символов`);\n  } else {\n    listingTitle.setCustomValidity('');\n  }\n\n  listingTitle.reportValidity();\n})\n\nlistingTypeSelect.addEventListener('change', () => {\n  pricePerNightInput.min = MIN_PRICES[listingTypeSelect.value];\n  pricePerNightInput.placeholder = MIN_PRICES[listingTypeSelect.value];\n});\n\ncheckinTimeSelect.addEventListener('change', () => {\n  setTimeDependence(checkinTimeSelect, checkoutTimeSelect);\n});\n\ncheckoutTimeSelect.addEventListener('change', () => {\n  setTimeDependence(checkoutTimeSelect, checkinTimeSelect);\n});\n\nroomQuantityField.addEventListener('change', () => {\n  setRoomGuestsDependence(roomQuantityField, guestQuantityField);\n});\n\nsubmitButton.addEventListener('click', () => {\n  validatePrice(pricePerNightInput);\n  validateTitleInput(listingTitle);\n});\n\nadForm.addEventListener('submit', (evt) => {\n  evt.preventDefault();\n\n  const formData = new FormData(evt.target);\n  sendData(formData);\n});\n\nadForm.addEventListener('reset', () => {\n  mainMarker.setLatLng(MAIN_PIN_COORDINATES);\n  setTimeout(() => {\n    addressField.value = `${MAIN_PIN_COORDINATES.lat}, ${MAIN_PIN_COORDINATES.lng}`;\n  }, 0)\n});\n","import {\n  generateRandomInteger,\n  generateRandomFloat,\n  getRandomValue,\n  generateRandomList\n} from './util.js';\n\nconst LISTING_TITLES = [\n  'Какой-то очень классный заголовок',\n  'Креативный тайтл для листинга',\n]\nconst LISTING_DESCRIPTIONS = [\n  'Комфортабельная, почти целая коробка из под холодильника, прийдется по вкусу не только дворовым котам, избалованные вискасом гурманы также останутся довольны',\n  'Прохладная землянка, подойдет не только северным мишкам, бобры также останутся довольны',\n  'Гнездо из еловых веток с видом на горы - идеальное место для гордых орлов',\n]\nconst LISTING_TYPES = [\n  'palace',\n  'flat',\n  'house',\n  'bungalow',\n];\nconst REGISTER_HOURS = [\n  '12:00',\n  '13:00',\n  '14:00',\n];\nconst FEATURES_LIST = [\n  'wifi',\n  'dishwasher',\n  'parking',\n  'washer',\n  'elevator',\n  'conditioner',\n];\nconst PHOTOS_LIST = [\n  'http://o0.github.io/assets/images/tokyo/hotel1.jpg',\n  'http://o0.github.io/assets/images/tokyo/hotel2.jpg',\n  'http://o0.github.io/assets/images/tokyo/hotel3.jpg',\n];\nexport const GENERATE_LIST_OF_ADS_COUNT = 10;\n\nconst createAd = () => {\n  return {\n    author: {\n      avatar: `img/avatars/user0${generateRandomInteger(1, 8)}.png`,\n    },\n    offer: {\n      title: getRandomValue(LISTING_TITLES),\n      address: `${generateRandomFloat(35.65000, 35.70000, 5)},${generateRandomFloat(139.70000, 139.80000, 5)}`,\n      price: generateRandomInteger(100, 500),\n      type: getRandomValue(LISTING_TYPES),\n      rooms: generateRandomInteger(1, 100),\n      guests: generateRandomInteger(1, 100),\n      checkin: getRandomValue(REGISTER_HOURS),\n      checkout: getRandomValue(REGISTER_HOURS),\n      features: generateRandomList(FEATURES_LIST),\n      description: getRandomValue(LISTING_DESCRIPTIONS),\n      photos: generateRandomList(PHOTOS_LIST),\n    },\n    location: {\n      lat: generateRandomFloat(35.65000, 35.70000, 5),\n      lng: generateRandomFloat(139.70000, 139.80000, 5),\n    },\n  }\n}\n\nexport const generateListOfAds = () => {\n  return new Array(GENERATE_LIST_OF_ADS_COUNT).fill('').map(() => createAd());\n}\n","/* global L:readonly */\n\nimport {\n  adForm,\n  setElementsAvailability\n} from './disable.js';\n\nimport {\n  filterAll,\n  mapFilters\n} from './filter.js';\n\nimport { createCustomPopup } from './popup.js';\n\nimport {\n  addressField,\n  submitButton,\n  resetButton\n} from './form.js';\n\nimport { getData } from './data.js';\n\nimport { GENERATE_LIST_OF_ADS_COUNT } from './ad-list.js';\n\nimport { debounce } from './debounce.js';\n\nimport { resetForm } from './reset.js';\n\nconst RENDER_DELAY = 500;\n\nexport const MAIN_PIN_COORDINATES = {\n  lat: 35.6801,\n  lng: 139.7655,\n}\n\nexport const mapContainer = document.querySelector('.map');\n\nexport const map = L.map('map-canvas');\n\nmap.on('load', () => {\n  adForm.classList.remove('ad-form--disabled');\n  mapFilters.classList.remove('map__filters--disabled');\n  setElementsAvailability(adForm, 'input', 'true');\n  setElementsAvailability(adForm, 'select', 'true');\n  setElementsAvailability(adForm, 'button', 'true');\n  setElementsAvailability(adForm, 'textarea', 'true');\n  getData((data) => {\n    renderSimilarAds(data);\n    setElementsAvailability(mapFilters, 'input', 'true');\n    setElementsAvailability(mapFilters, 'select', 'true');\n    mapFilters.addEventListener('change', () => {\n      (debounce(() => {\n        removeUnmatchedAds();\n        renderSimilarAds(filterAll(data));\n      }, RENDER_DELAY))();\n    });\n\n    resetButton.addEventListener('click', () => {\n      resetForm();\n      renderSimilarAds(data);\n    });\n\n    submitButton.addEventListener('click', () => renderSimilarAds(data))\n  }, mapContainer);\n})\n\nmap.setView(MAIN_PIN_COORDINATES, 10);\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n\nconst mainPinIcon = L.icon({\n  iconUrl: 'img/main-pin.svg',\n  iconSize: [38, 95],\n  iconAnchor: [22, 94],\n  popupAnchor: [-3, -76],\n});\n\nexport const pinIcon = L.icon({\n  iconUrl: 'img/pin.svg',\n  iconSize: [38, 95],\n  iconAnchor: [22, 94],\n  popupAnchor: [-3, -76],\n});\n\nexport const mainMarker = L.marker(\n  MAIN_PIN_COORDINATES,\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n);\n\naddressField.value = `${MAIN_PIN_COORDINATES.lat}, ${MAIN_PIN_COORDINATES.lng}`;\naddressField.setAttribute('readonly', 'readonly');\n\nmainMarker.on('dragend', () => {\n  addressField.value = `${mainMarker.getLatLng().lat.toFixed(5)}, ${mainMarker.getLatLng().lng.toFixed(5)}`;\n})\n\nmainMarker.addTo(map);\n\nexport const renderSimilarAds = (similarAdsList) => {\n  similarAdsList.slice(0, GENERATE_LIST_OF_ADS_COUNT).forEach(({ author, offer, location: { lat, lng } }) => {\n    const marker = L.marker({\n      lat,\n      lng,\n    },\n    {\n      keepInView: true,\n      icon: pinIcon,\n    },\n    );\n\n    marker\n      .addTo(map)\n      .bindPopup(createCustomPopup({ author, offer }));\n  });\n};\n\nexport const removeUnmatchedAds = () => {\n  map.eachLayer((marker) => {\n    if (marker instanceof L.Marker && marker !== mainMarker) {\n      marker.remove();\n    }\n  })\n};\n","export const debounce = (func, delay) => {\n  let timerId;\n  return (...args) => {\n    const boundFunc = func.bind(this, ...args);\n    clearTimeout(timerId);\n    timerId = setTimeout(boundFunc, delay);\n  }\n};\n"],"sourceRoot":""}